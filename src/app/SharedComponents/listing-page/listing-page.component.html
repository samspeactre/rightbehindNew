<div class="main-section">
  <app-banner [show]="show">
    <div class="container">
      <div
        class="pb-3"
        [class.sec-1]="(resize.windowSize$ | async)?.width > 1024"
        [class.py-3]="(resize.windowSize$ | async)?.width <= 1024"
      >
        @if((resize.windowSize$ | async)?.width > 1024){
        <div [ngClass]="{ 'd-none': show }">
          <ngx-typed-writer
            [strings]="[
              url == '/communities'
                ? '<h1>Find The Best Communities In Miami.</h1>'
                : '<h1>Find The Best Rental Deals In Miami.</h1>'
            ]"
            [isHTML]="true"
            [typeSpeed]="30"
            [loop]="false"
            [showCursor]="false"
          ></ngx-typed-writer>
          @if(url != '/communities'){
          <h5 class="wow fadeInDown text-center mb-3">
            Move in with just a
            <strong>security deposit, a month free</strong> and more

            <img
              src="../../../assets/video/fire.gif"
              class="fire-animation"
              alt=""
            />
          </h5>
          }
        </div>
        }
        <div
          class="wow fadeInDown search-bar position-relative"
          [class.my-3]="(resize.windowSize$ | async)?.width > 1024"
        >
          <div [ngClass]="{ 'd-none': show }">
            <app-search-bar
              [search]="search"
              (searchEvent)="searchProperties($event)"
              [searching]="loader"
              [filter]="url != '/communities'"
              (showFilter)="showFil($event)"
              [show]="show"
            ></app-search-bar>
          </div>
          <div class="show" [ngClass]="[show ? 'd-block' : 'd-none']">
            @if(show){
            <app-filter
              [searching]="loader"
              [types]="types"
              [bedsArray]="bedsArray"
              [bathArray]="bathArray"
              [sortsArray]="sortsArray"
              [minPrices]="minPrices"
              [maxPrices]="maxPrices"
              [a]="type"
              [b]="beds"
              [c]="baths"
              [d]="sort"
              [e]="minPrice"
              [f]="maxPrice"
              [filterType]="filterType"
              [isResetDisabled]="isResetDisabled()"
              (onChangeFilter)="onFilterChange($event.event, $event.type)"
              (onRangeFilter)="onRangeFilter()"
              (rest)="reset()"
              (sorted)="sorting($event)"
              (closed)="closeFil()"
            ></app-filter>
            }
          </div>
        </div>
      </div>
    </div>
  </app-banner>

  <div class="position-relative" [ngClass]="{ cstmZIndex: show }">
    <div class="cstmContainer" [style.min-height.px]="screenHeight">
      <div class="row">
        <div class="col-lg-12 wow fadeInDown" #listing>
          @if(loader){
          <p style="height: 16px" class="w-75 skeleton my-3"></p>
          } @else {
          <div class="dCenter justify-content-between">
            <h5 class="my-3">
              {{ cards?.length }}
              @if(url == '/communities'){ Communities }@else{ Properties } Found
            </h5>
            @if((resize.windowSize$ | async)?.width <= 1024){
            <button
              class="btnToggler smallFont d-flex align-items-center"
              title="Show Properties On {{ showMapClicked ? 'List' : 'Map' }}"
              (click)="showMapClicked = !showMapClicked"
            >
              {{ showMapClicked ? "Grid View" : "Map View" }}
              <fa-icon
                class="ms-1"
                [icon]="showMapClicked ? faBuilding : faMap"
              ></fa-icon>
            </button>
            }
          </div>
          }
        </div>
        @if(url == '/communities'){ @if((resize.windowSize$ | async)?.width >
        1024 || showMapClicked){
        <div class="col-lg-12 wow fadeInDown mb-3">
          @if(latLngArray?.length){
          <app-map-draw
            (drawCordinates)="drawSearch($event)"
            (propertyHover)="highlightCard($event)"
            [highlighted]="highlighted"
            [communityMarkerPositions]="latLngArray"
            [center]="latLngArray?.[1]"
            [community]="true"
            [infoContents]="cards"
            [height]="(resize.windowSize$ | async)?.width > 1024 ? 300 : 200"
          ></app-map-draw>
          }
        </div>
        } } @if(!showMapClicked){
        <div
          class="wow fadeInDown"
          [ngClass]="[url == '/communities' ? 'col-lg-12' : 'col-lg-5']"
          #listing
        >
          <div class="row">
            @if(cards?.length){ @for (card of cards; track card) {
            <div
              class="mb-3 wow fadeInDown"
              [ngClass]="[url == '/communities' ? 'col-lg-3' : 'col-lg-12']"
            >
              @if(url == '/communities'){
              <app-community-card
                (propertyHover)="hover($event)"
                [item]="card"
                [loader]="loader"
              ></app-community-card>
              }@else {
              <app-property-card
                page="listView"
                background="#e6f2ff"
                [card]="card"
                [loader]="loader"
                type="component"
                (propertyHover)="hover($event)"
              ></app-property-card>
              }
            </div>
            } }
            <div class="col-lg-12">
              @if(loadMore){
              <div class="dCenter">
                @if(loadMoreLoader){
                <div class="wow fadeInDown mb-3">
                  <app-mini-loading></app-mini-loading>
                </div>
                } @else{ @if(cards?.length >= 20){
                <button
                  class="btnPrimary py-1 wow fadeInDown mb-3"
                  (click)="
                    loadMoreProperties(
                      url == '/communities' ? 'communities' : 'properties'
                    )
                  "
                >
                  Load More
                </button>
                } }
              </div>
              }
            </div>
          </div>
        </div>
        } @if(url != '/communities'){ @if((resize.windowSize$ | async)?.width >
        1024 || showMapClicked){
        <div class="col-lg-7 wow fadeInDown rightP">
          <div class="mapElement">
            @if(cards?.length && latLngArray?.length){
            <app-map-draw
              (drawCordinates)="drawSearch($event)"
              (propertyHover)="highlightCard($event)"
              [highlighted]="highlighted"
              [markerPositions]="latLngArray"
              [center]="latLngArray?.[0]"
              [infoContents]="cards"
              [height]="screenHeight"
            ></app-map-draw>
            }
          </div>
        </div>
        } } @if(!cards?.length && !loader){
        <div class="col-lg-12">
          <p class="text-danger text-center">
            No
            {{ url == "/communities" ? "communities" : "properties" }} found
          </p>
        </div>
        }
      </div>
    </div>
  </div>
</div>
