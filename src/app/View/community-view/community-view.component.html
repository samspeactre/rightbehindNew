<div class="feed me-3 mt-4">
  <div class="post rounded-3">
    <div class="post__comments removeBorder">
      <div
        class="comment-create rounded-3"
        style="background: transparent; padding: 12px 8px"
      >
        <img
          class="comment__profile-img"
          [src]="
            userDetails?.imageUrl
              ? src + userDetails?.imageUrl
              : 'https://beforeigosolutions.com/wp-content/uploads/2021/12/dummy-profile-pic-300x300-1.png'
          "
          alt="My Profile Picture"
        />
        <div class="inputBox position-relative">
          <input
            class="input"
            [title]="join ? 'yout Post here' : 'Join first to add post'"
            [readOnly]="!join"
            placeholder="Share what's on your mind..."
            [(ngModel)]="post"
            style="background-color: #e6f2ff"
          />
          <button
            [disabled]="!post"
            class="bg-transparent border-0"
            (click)="createPost()"
          >
            <fa-icon
              [icon]="faPlus"
              class="position-absolute btnIcon"
            ></fa-icon>
          </button>
        </div>
      </div>
    </div>
  </div>
  @for (item of posts; track $index) {
  <div class="post mt-2 mb-3 rounded-3">
    <div class="post__top">
      <div class="post__top-left">
        <img
          class="post__profile-img"
          [src]="
            item?.user?.imageUrl
              ? src + item?.user?.imageUrl
              : 'https://beforeigosolutions.com/wp-content/uploads/2021/12/dummy-profile-pic-300x300-1.png'
          "
          alt="profile pic"
        />
        <a class="post__profile-name" (click)="routeToCommunity(item?.id)">{{
          item?.user?.fullName
        }}</a>
      </div>
      <div>
        <span class="post__date-posted">{{ item?.createdAt | amTimeAgo }}</span>
      </div>
    </div>
    <div class="post__content">
      <p class="p">
        {{ item?.title }}
      </p>
    </div>
    <div class="post__footer">
      <button
        class="footer-link bg-transparent border-0"
        [disabled]="(item?.userReaction && item?.isReactedByUser) || !join"
        (click)="react(true, item?.id)"
      >
        <fa-icon [icon]="faArrowUp"></fa-icon>
        {{ item?.likeCount }}
      </button>
      <button
        class="footer-link bg-transparent border-0"
        [disabled]="(item?.userReaction && !item?.isReactedByUser) || !join"
        (click)="react(false, item?.id)"
      >
        <fa-icon [icon]="faArrowDown"></fa-icon>
        {{ item?.dislikeCount }}
      </button>
      <button class="footer-link bg-transparent border-0">
        <fa-icon [icon]="faComment"></fa-icon>
        {{ item?.forumPostAnswers?.length }}
      </button>
    </div>
    <div class="post__comments">
      <h6 class="bold mb-2 mt-2">Comments</h6>
      @for (comment of item?.forumPostAnswers | slice:0:2; track $index) {
      <div
        class="comment rounded-3"
        style="
          background-color: #e6f2ff;
          align-items: flex-start;
          padding: 6px 8px;
          padding-bottom: 0;
          margin: 10px 0;
        "
      >
        <img
          class="comment__profile-img"
          [src]="
            comment?.user?.imageUrl
              ? src + comment?.user?.imageUrl
              : 'https://beforeigosolutions.com/wp-content/uploads/2021/12/dummy-profile-pic-300x300-1.png'
          "
          alt="commentator"
        />
        <div class="comment__content w-100" style="padding: 4px 0">
          <div class="d-flex justify-content-between align-items-center w-100">
            <a class="comment-name">{{ comment?.user?.fullName }}</a>
            <span class="post__date-posted smallFont mb-0">{{
              comment?.createdAt | amTimeAgo
            }}</span>
          </div>
          <p class="comment__text" style="padding: 4px 6px; padding-left: 0">
            {{ comment?.answer }}
          </p>
        </div>
      </div>
      } @if(item?.forumPostAnswers?.length > 2){
        <div class="d-flex justify-content-end my-2">
          <a
            (click)="routeToCommunity(item?.id)"
            class="bg-transparent border-0 smallFont text-dark reg"
          >
            View More
        </a>
        </div>
      }
      <div
        class="comment-create rounded-3"
        style="background: transparent; padding: 12px 8px"
      >
        <img
          class="comment__profile-img"
          [src]="
            userDetails?.imageUrl
              ? src + userDetails?.imageUrl
              : 'https://beforeigosolutions.com/wp-content/uploads/2021/12/dummy-profile-pic-300x300-1.png'
          "
          alt="My Profile Picture"
        />
        <div class="inputBox position-relative">
          <input
            [title]="join ? 'Comment here' : 'Join first to comment'"
            [readOnly]="!join"
            class="input"
            placeholder="Add a comment"
            [(ngModel)]="comment"
            style="background-color: #e6f2ff"
          />
          <button
            [disabled]="!comment"
            class="bg-transparent border-0"
            (click)="createComment(item?.id)"
          >
            <fa-icon
              [icon]="faPaperPlane"
              class="position-absolute btnIcon"
            ></fa-icon>
          </button>
        </div>
      </div>
    </div>
  </div>
  }
</div>
