<div class="position-relative overflow-hidden">
  <div
    class="position-sticky top-0 zIndex bg-white py-2 wow fadeInDown"
    [class.bg-transparent]="show"
    [class.py-0]="show"
    id="searchHeight"
  >
    <div class="cstmContainer section-width">
      <div [ngClass]="{ 'd-none': show }">
        <app-search-bar-listing
          [search]="search"
          (searchEvent)="searchProperties($event)"
          [searching]="loader"
          [filter]="true"
          (showFilter)="showFil($event)"
          [show]="show"
        ></app-search-bar-listing>
      </div>
      <div class="show" [ngClass]="[show ? 'd-block' : 'd-none']">
        @if(show){
        <app-filter
          [searching]="loader"
          [types]="types"
          [bedsArray]="bedsArray"
          [bathArray]="bathArray"
          [sortsArray]="sortsArray"
          [minPrices]="minPrices"
          [maxPrices]="maxPrices"
          [a]="type"
          [b]="beds"
          [c]="baths"
          [d]="sort"
          [e]="minPrice"
          [f]="maxPrice"
          [filterType]="filterType"
          [isResetDisabled]="isResetDisabled()"
          (onChangeFilter)="onFilterChange($event.event, $event.type)"
          (onRangeFilter)="onRangeFilter()"
          (rest)="reset()"
          (sorted)="sorting($event)"
          (closed)="closeFil()"
        ></app-filter>
        }
      </div>
      <div class="dCenter justify-content-between">
        @if((resize.windowSize$ | async)?.width <= 1024){
        <button
          class="btnToggler smallFont d-flex align-items-center"
          title="Show Properties On {{ showMapClicked ? 'List' : 'Map' }}"
          (click)="showMapClicked = !showMapClicked"
        >
          {{ showMapClicked ? "Grid View" : "Map View" }}
          <fa-icon
            class="ms-1"
            [icon]="showMapClicked ? faBuilding : faMap"
          ></fa-icon>
        </button>
        }
      </div>
    </div>
  </div>
  <div class="cstmContainer overflow-hidden section-width">
    <div class="w-100 d-flex align-items-start justify-content-between">
      <div class="colFirst">
        <div
          class="row overflow-y-auto p-0"
          [class.w-100]="(resize.windowSize$ | async)?.width > 1024"
          [style.height.px]="screenHeight"
        >
          @if(cards?.length){ @for (card of cards; track card) {
          <div class="mb-3 col-lg-12" #listing>
            <app-property-card
              [animation]="false"
              page="listView"
              [card]="card"
              [loader]="loader"
              type="component"
              (propertyHover)="hover($event)"
              (propertyHoverLeft)="hoverLeft($event)"
            ></app-property-card>
          </div>
          } }
          <div class="col-lg-12">
            @if(loadMore){
            <div class="dCenter">
              @if(loadMoreLoader){
              <div class="mb-3">
                <app-mini-loading></app-mini-loading>
              </div>
              } @else{ @if(cards?.length >= 40){
              <button
                class="btnPrimary py-1 mb-3"
                (click)="loadMoreProperties('communities')"
              >
                Load More
              </button>
              } }
            </div>
            }
          </div>
        </div>
      </div>
      @if((resize.windowSize$ | async)?.width > 1024 || showMapClicked){
      <div class="colSecond rightP" [style.top.px]="searchHeight">
        <app-dummy-map
          [place_id]="place_id"
          [disabled]="loader"
          (resetDrawCordinates)="resetCordinates($event)"
          (drawCordinates)="drawSearch($event)"
          (propertyHover)="highlightCard($event)"
          [highlighted]="highlighted"
          [removeHighlighted]="removeHighlighted"
          [markerPositions]="latLngArray"
          [center]="latLngArray?.[0]"
          [highlightedAreaCoordinates]="latLngArray"
          [infoContents]="cards"
          [height]="screenHeight"
        ></app-dummy-map>
      </div>
      }
    </div>
  </div>
</div>
